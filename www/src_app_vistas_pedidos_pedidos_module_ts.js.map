{"version":3,"file":"src_app_vistas_pedidos_pedidos_module_ts.js","mappings":"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","sources":["./src/app/vistas/pedidos/pedidos-routing.module.ts","./src/app/vistas/pedidos/pedidos.module.ts","./src/app/vistas/pedidos/pedidos.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { PedidosPage } from './pedidos.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: PedidosPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class PedidosPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { PedidosPageRoutingModule } from './pedidos-routing.module';\r\n\r\nimport { PedidosPage } from './pedidos.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    PedidosPageRoutingModule\r\n  ],\r\n  declarations: [PedidosPage]\r\n})\r\nexport class PedidosPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { AngularFireDatabase } from '@angular/fire/compat/database';\r\nimport { AngularFireAuth } from '@angular/fire/compat/auth';\r\n\r\n@Component({\r\n  selector: 'app-pedidos',\r\n  templateUrl: './pedidos.page.html',\r\n  styleUrls: ['./pedidos.page.scss'],\r\n})\r\nexport class PedidosPage implements OnInit {\r\n  uid: string;\r\n  pedidos: any[] = [];\r\n  codigo: string;\r\n\r\n  constructor(private afAuth: AngularFireAuth, private db: AngularFireDatabase) {\r\n    this.afAuth.authState.subscribe((user) => {\r\n      if (user) {\r\n        this.uid = user.uid;\r\n        this.obtenerPedidosUsuario(this.uid);\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnInit() {}\r\n\r\n  //Funcion que captura los pedidos del cliente y los lista en el carrito \r\n  obtenerPedidosUsuario(uid: string) {\r\n    this.db.object(`CarritoPedidos/${uid}`).valueChanges().subscribe((data: any) => {\r\n      if (data) {\r\n        this.pedidos = Object.values(data);\r\n        console.log('Pedidos:', this.pedidos);\r\n      } else {\r\n        console.log('No se recibieron datos.');\r\n      }\r\n    });\r\n  }\r\n  \r\n  //Funcion para obtener json con descuentos \r\n  obtenerCodigoDescuento(codigo: string) {\r\n    this.db.object(`CodigoDescuentos/${codigo}`).valueChanges().subscribe((data: any) => {\r\n      if (data && data.Codigo) {\r\n        this.codigo = data.Codigo; // Asigna el código de descuento a this.codigo\r\n        console.log('Código de descuento:', this.codigo);\r\n      } else {\r\n        console.log('No se recibieron datos o no se encontró el código de descuento.');\r\n      }\r\n    });\r\n  }\r\n  \r\n  \r\n\r\n\r\n  //Elimina pedido de carrito de compra\r\n  eliminarPedidosDelUsuario(usuarioID: string) {\r\n    this.db.object(`CarritoPedidos/${usuarioID}`).remove()\r\n      .then(() => {\r\n        console.log('Pedidos del usuario eliminados exitosamente.');\r\n        this.pedidos = []; // Limpiar la lista después de eliminar\r\n      })\r\n      .catch((error) => {\r\n        console.error('Error al eliminar los pedidos del usuario:', error);\r\n      });\r\n  }\r\n\r\n  //Calcula el total de la compra sumando los precios del carrito \r\n  calcularTotal(): number {\r\n    let total = 0;\r\n    if (this.pedidos && this.pedidos.length > 0) {\r\n      this.pedidos.forEach((pedido: any) => {\r\n        total += pedido?.Pedido?.precio || 0; // Suma el precio del pedido al total\r\n\r\n      });\r\n    }\r\n    return total;\r\n  }\r\n\r\n\r\n  \r\n  \r\n}\r\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}