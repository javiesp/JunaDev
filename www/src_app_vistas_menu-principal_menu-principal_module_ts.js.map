{"version":3,"file":"src_app_vistas_menu-principal_menu-principal_module_ts.js","mappings":"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","sources":["./src/app/vistas/menu-principal/menu-principal-routing.module.ts","./src/app/vistas/menu-principal/menu-principal.module.ts","./src/app/vistas/menu-principal/menu-principal.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { MenuPrincipalPage } from './menu-principal.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: MenuPrincipalPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class MenuPrincipalPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { MenuPrincipalPageRoutingModule } from './menu-principal-routing.module';\r\n\r\nimport { MenuPrincipalPage } from './menu-principal.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    MenuPrincipalPageRoutingModule\r\n  ],\r\n  declarations: [MenuPrincipalPage]\r\n})\r\nexport class MenuPrincipalPageModule {}\r\n","import { Component, OnInit, Renderer2, OnDestroy, ElementRef, ViewChild } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { LoadingController } from '@ionic/angular';\r\nimport { AngularFireDatabase } from '@angular/fire/compat/database';\r\nimport { AngularFireAuth } from '@angular/fire/compat/auth';\r\nimport { ActionSheetController, AlertController } from '@ionic/angular';\r\nimport { GmapsService } from 'src/app/servicios/gmaps.service';\r\n\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'app-menu-principal',\r\n  templateUrl: './menu-principal.page.html',\r\n  styleUrls: ['./menu-principal.page.scss'],\r\n})\r\n\r\nexport class MenuPrincipalPage implements OnInit, OnDestroy {\r\n  restaurantes: any[] = [];\r\n  menuRestaurante: any[];\r\n  restauranteSeleccionado: any;\r\n\r\n  @ViewChild('map', {static: true}) mapElementRef: ElementRef;\r\n  googleMaps: any;\r\n  center = { lat: -33.59792458336969, lng: -70.70543417692222 };\r\n  map: any;\r\n  mapClickListener: any;\r\n  markerClickListener: any;\r\n  markers: any[] = [];\r\n\r\n\r\n  constructor(private router: Router,\r\n              private loadingController: LoadingController,\r\n              private db: AngularFireDatabase, \r\n              private afAuth: AngularFireAuth,\r\n              private gmaps: GmapsService,\r\n              private renderer: Renderer2,\r\n              private actionSheetCtrl: ActionSheetController\r\n              ) { }\r\n\r\n  ngOnDestroy(): void {\r\n    throw new Error('Method not implemented.');\r\n    if(this.mapClickListener) this.googleMaps.event.removeListener(this.mapClickListener);\r\n    if(this.markerClickListener) this.googleMaps.event.removeListener(this.markerClickListener);\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.cargarGMap();\r\n  }\r\n\r\n\r\n  //Funcion para mostrar los tipos de restarantes\r\n  getMenuRestaurante(restauranteId: string) {\r\n    const restaurante = this.restaurantes.find((rest) => rest.id === restauranteId);\r\n    if (restaurante) {\r\n      this.restauranteSeleccionado = restaurante.nombre;\r\n      this.menuRestaurante = restaurante.menu;\r\n    }\r\n  }\r\n\r\n  async ionViewWillEnter() {\r\n    const loading = await this.loadingController.create({\r\n      message: 'Cargando, espere un momento...', // Mensaje que se mostrará\r\n      duration: 500 // Duración en milisegundos (ajusta según tus necesidades)\r\n    });\r\n    \r\n    await loading.present();\r\n    \r\n    //Carga los elementos a listar\r\n    this.db.list('restaurantes').valueChanges().subscribe((data: any[]) => { //Busca la data y las guarda en this.restaurantes\r\n      this.restaurantes = data;\r\n    });\r\n  }\r\n\r\n  \r\n  async cargarGMap(){\r\n    try {\r\n      let googleMaps: any = await this.gmaps.loadGoogleMaps();\r\n      this.googleMaps = googleMaps;\r\n      const mapEl = this.mapElementRef.nativeElement;\r\n      const location = new googleMaps.LatLng(this.center.lat, this.center.lng);\r\n      this.map = new googleMaps.Map(mapEl, {\r\n        center: location,\r\n        zoom: 12,\r\n      });\r\n      this.renderer.addClass(mapEl, 'visible');\r\n      this.addMarker(location);\r\n      this.onMapClick();\r\n    } catch(e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  \r\n  onMapClick() {\r\n    this.mapClickListener = this.googleMaps.event.addListener(this.map, \"click\", (mapsMouseEvent) => {\r\n      console.log(mapsMouseEvent.latLng.toJSON());\r\n      this.addMarker(mapsMouseEvent.latLng);\r\n    });\r\n  }\r\n\r\n  addMarker(location) {\r\n    let googleMaps: any = this.googleMaps;\r\n    const icon = {\r\n      url: 'assets/icon/isotipo.png',\r\n      scaledSize: new googleMaps.Size(50, 50), \r\n    };\r\n    const marker = new googleMaps.Marker({\r\n      position: location,\r\n      map: this.map,\r\n      icon: icon,\r\n      // draggable: true,\r\n      animation: googleMaps.Animation.DROP\r\n    });\r\n    this.markers.push(marker);\r\n    // this.presentActionSheet();\r\n    this.markerClickListener = this.googleMaps.event.addListener(marker, 'click', () => {\r\n      console.log('markerclick', marker);\r\n      this.checkAndRemoveMarker(marker);\r\n      console.log('markers: ', this.markers);\r\n    });\r\n  }\r\n\r\n  checkAndRemoveMarker(marker) {\r\n    const index = this.markers.findIndex(x => x.position.lat() == marker.position.lat() && x.position.lng() == marker.position.lng());\r\n    console.log('is marker already: ', index);\r\n    if(index >= 0) {\r\n      this.markers[index].setMap(null);\r\n      this.markers.splice(index, 1);\r\n      return;\r\n    }\r\n  }\r\n\r\n  async presentActionSheet() {\r\n    const actionSheet = await this.actionSheetCtrl.create({\r\n      header: 'Added Marker',\r\n      subHeader: '',\r\n      buttons: [\r\n        {\r\n          text: 'Remove',\r\n          role: 'destructive',\r\n          data: {\r\n            action: 'delete',\r\n          },\r\n        },\r\n        {\r\n          text: 'Save',\r\n          data: {\r\n            action: 'share',\r\n          },\r\n        },\r\n        {\r\n          text: 'Cancel',\r\n          role: 'cancel',\r\n          data: {\r\n            action: 'cancel',\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    await actionSheet.present();\r\n  }\r\n\r\n\r\n\r\n  \r\n\r\n}\r\n"],"names":["Component","Renderer2","ViewChild","Router","LoadingController","AngularFireDatabase","AngularFireAuth","ActionSheetController","GmapsService","MenuPrincipalPage","constructor","router","loadingController","db","afAuth","gmaps","renderer","actionSheetCtrl","lat","lng","ngOnDestroy","Error","mapClickListener","googleMaps","event","removeListener","markerClickListener","ngOnInit","ngAfterViewInit","cargarGMap","getMenuRestaurante","restauranteId","restaurante","restaurantes","find","rest","id","restauranteSeleccionado","nombre","menuRestaurante","menu","ionViewWillEnter","loading","create","message","duration","present","list","valueChanges","subscribe","data","loadGoogleMaps","mapEl","mapElementRef","nativeElement","location","LatLng","center","map","Map","zoom","addClass","addMarker","onMapClick","e","console","log","addListener","mapsMouseEvent","latLng","toJSON","icon","url","scaledSize","Size","marker","Marker","position","animation","Animation","DROP","markers","push","checkAndRemoveMarker","index","findIndex","x","setMap","splice","presentActionSheet","actionSheet","header","subHeader","buttons","text","role","action","args","static","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}