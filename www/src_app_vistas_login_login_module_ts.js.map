{"version":3,"file":"src_app_vistas_login_login_module_ts.js","mappings":"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","sources":["./src/app/vistas/login/login-routing.module.ts","./src/app/vistas/login/login.module.ts","./src/app/vistas/login/login.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPageRoutingModule } from './login-routing.module';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    LoginPageRoutingModule\r\n  ],\r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { AlertController, LoadingController } from '@ionic/angular';\r\nimport { FireserviceService } from 'src/app/servicios/fireservice.service';\r\nimport { DataService } from 'src/app/servicios/data.service';\r\nimport { ChangeDetectorRef } from '@angular/core';\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage implements OnInit {\r\n  \r\n  public email:any;\r\n  public password: any;\r\n\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private loadingCtrl: LoadingController,\r\n    public fireservice:FireserviceService,\r\n    private alertController:AlertController,\r\n    private dataService: DataService,\r\n    private cdRef: ChangeDetectorRef,  // Agrega ChangeDetectorRef aquí\r\n    \r\n  ) {}\r\n  \r\n  ngOnInit() {\r\n    // Verificar si hay un usuario en el almacenamiento local al cargar la página\r\n    this.verificarUsuarioAlCargarPagina();\r\n  }\r\n\r\n  // Esta función se ejecuta cuando se presiona el botón de inicio de sesión.\r\n  async login() {\r\n    if (!this.email || !this.password) {\r\n      await this.presentAlert('Por favor, ingresa un correo electrónico y una contraseña.');\r\n      return;\r\n    }\r\n    this.showLoading();\r\n    try {\r\n      const res = await this.fireservice.loginWithEmail({ email: this.email, password: this.password });\r\n      console.log(res);\r\n      if (res.user.uid) {\r\n        this.fireservice.getDetails({ uid: res.user.uid }).subscribe(\r\n          async (userData) => {\r\n            console.log(userData);\r\n            await this.dataService.guardarUsuario(userData); // Guardar información del usuario en el almacenamiento local\r\n            this.loadingCtrl.dismiss();\r\n            this.router.navigate(['/menu-principal']);\r\n          },\r\n          (err) => {\r\n            console.log(err);\r\n            this.loadingCtrl.dismiss();\r\n          }\r\n        );\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      // Verifica el tipo de error para mostrar el mensaje adecuado\r\n      if (err.code === 'auth/wrong-password' || err.code === 'auth/user-not-found') {\r\n        await this.presentAlert('Usuario o contraseña incorrectos');\r\n      } else {\r\n        await this.presentAlert('Ocurrió un error al iniciar sesión. Por favor, intenta de nuevo más tarde.');\r\n      }\r\n      this.loadingCtrl.dismiss();\r\n    }\r\n  }\r\n  \r\n\r\n  // Verificar si hay un usuario en el almacenamiento local al cargar la página\r\n  async verificarUsuarioAlCargarPagina() {\r\n    const usuarioGuardado = await this.dataService.obtenerUsuario();\r\n    if (usuarioGuardado) {\r\n      // Si hay un usuario almacenado, navegar directamente al menú principal\r\n      this.router.navigate(['/menu-principal']);\r\n    }\r\n  }\r\n\r\n  // Función para mostrar el cuadro de alerta\r\n  async presentAlert(mensaje: string) {\r\n    const alert = await this.alertController.create({\r\n      header: 'Alerta',\r\n      message: mensaje,\r\n      buttons: ['OK'],\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  // Función para mostrar el indicador de carga\r\n  async showLoading() {\r\n    const loading = await this.loadingCtrl.create({\r\n      message: 'Cargando...',\r\n      duration: 5000,\r\n    });\r\n    await loading.present();\r\n  }\r\n\r\n\r\n\r\n    // Esta función se ejecuta cuando se presiona el botón de registro.\r\n  // Redirige al usuario a la página de registro.\r\n  signup() {\r\n    this.router.navigate(['/registro']); // Redirige a la página de registro\r\n  }\r\n\r\n  \r\n\r\n\r\n\r\n\r\n}\r\n"],"names":["Component","Router","AlertController","LoadingController","FireserviceService","DataService","ChangeDetectorRef","LoginPage","constructor","router","loadingCtrl","fireservice","alertController","dataService","cdRef","ngOnInit","verificarUsuarioAlCargarPagina","login","email","password","presentAlert","showLoading","res","loginWithEmail","console","log","user","uid","getDetails","subscribe","userData","guardarUsuario","dismiss","navigate","err","code","usuarioGuardado","obtenerUsuario","mensaje","alert","create","header","message","buttons","present","loading","duration","signup","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}